{"ast":null,"code":"var _jsxFileName = \"/home/cristian/Documentos/7mo/lenguajes_programacion/Videoconferencia-app/client/src/pages/Room.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport Peer from \"simple-peer\";\nimport io from \"socket.io-client\";\nimport { useAuth } from \"../context/AuthContext\";\nimport { useAudioLevel } from \"../hooks/useAudioLevel\";\nimport axios from \"axios\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Room() {\n  _s();\n  const {\n    roomId\n  } = useParams();\n  const {\n    user\n  } = useAuth();\n  const navigate = useNavigate();\n\n  // Media streams\n  const [myStream, setMyStream] = useState(null);\n  const [peers, setPeers] = useState([]);\n  const [screenStream, setScreenStream] = useState(null);\n\n  // UI state\n  const [audioEnabled, setAudioEnabled] = useState(true);\n  const [videoEnabled, setVideoEnabled] = useState(true);\n  const [showChat, setShowChat] = useState(true);\n  const [showPdf, setShowPdf] = useState(false);\n\n  // Chat\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState(\"\");\n\n  // PDF\n  const [pdfState, setPdfState] = useState(null);\n  const [uploadingPdf, setUploadingPdf] = useState(false);\n\n  // Active speakers\n  const [activeSpeakers, setActiveSpeakers] = useState(new Set());\n\n  // Refs\n  const myVideo = useRef();\n  const socketRef = useRef();\n  const peersRef = useRef([]);\n  const chatEndRef = useRef();\n  const fileInputRef = useRef();\n  const host = window.location.hostname;\n  const API_URL = `${window.location.protocol}//${host}:5000/api`;\n\n  // Detect if I'm speaking\n  const isSpeaking = useAudioLevel(myStream);\n  useEffect(() => {\n    if (isSpeaking) {\n      var _socketRef$current;\n      (_socketRef$current = socketRef.current) === null || _socketRef$current === void 0 ? void 0 : _socketRef$current.emit(\"user-speaking\", {\n        roomId,\n        userId: user.id,\n        userName: user.nombre\n      });\n    } else {\n      var _socketRef$current2;\n      (_socketRef$current2 = socketRef.current) === null || _socketRef$current2 === void 0 ? void 0 : _socketRef$current2.emit(\"user-stopped-speaking\", {\n        roomId,\n        userId: user.id\n      });\n    }\n  }, [isSpeaking]);\n  useEffect(() => {\n    // Check if mediaDevices is available (requires HTTPS or localhost)\n    if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {\n      alert(\"âš ï¸ WebRTC no estÃ¡ disponible.\\n\\n\" + \"Para usar video/audio, debes acceder desde:\\n\" + \"â€¢ http://localhost:3000 (en este equipo)\\n\" + \"â€¢ https://... (conexiÃ³n segura)\\n\\n\" + \"Actualmente estÃ¡s en: \" + window.location.href + \"\\n\\n\" + \"El chat y PDF funcionarÃ¡n, pero no el video.\");\n      // Continue without video/audio\n      socketRef.current = io.connect(`http://${host}:5000`);\n      const socket = socketRef.current;\n      socket.emit(\"join-room\", {\n        roomId,\n        userId: user.id,\n        userName: user.nombre\n      });\n      loadChatHistory();\n      return;\n    }\n\n    // Initialize socket\n    socketRef.current = io.connect(`http://${host}:5000`);\n    const socket = socketRef.current;\n\n    // Get user media\n    navigator.mediaDevices.getUserMedia({\n      video: true,\n      audio: true\n    }).then(currentStream => {\n      setMyStream(currentStream);\n      if (myVideo.current) {\n        myVideo.current.srcObject = currentStream;\n      }\n\n      // Join room\n      socket.emit(\"join-room\", {\n        roomId,\n        userId: user.id,\n        userName: user.nombre\n      });\n\n      // Load chat history\n      loadChatHistory();\n    }).catch(err => {\n      console.error(\"Error accessing media devices:\", err);\n      alert(\"No se pudo acceder a la cÃ¡mara o micrÃ³fono.\\n\\n\" + \"Posibles causas:\\n\" + \"â€¢ Permisos denegados\\n\" + \"â€¢ CÃ¡mara/micrÃ³fono en uso por otra app\\n\" + \"â€¢ Dispositivos no disponibles\\n\\n\" + \"El chat y PDF funcionarÃ¡n normalmente.\");\n\n      // Continue without video/audio\n      socket.emit(\"join-room\", {\n        roomId,\n        userId: user.id,\n        userName: user.nombre\n      });\n      loadChatHistory();\n    });\n\n    // Socket event listeners\n    socket.on(\"room-participants\", participants => {\n      console.log(\"Current participants:\", participants);\n      // Create peers for existing participants\n      participants.forEach(participant => {\n        if (participant.socketId !== socket.id && participant.socketId) {\n          createPeer(participant.socketId, socket.id, myStream);\n        }\n      });\n    });\n    socket.on(\"user-joined\", ({\n      userId: newUserId,\n      userName,\n      participants\n    }) => {\n      console.log(`${userName} joined`);\n      // The new user will initiate the connection\n    });\n    socket.on(\"offer\", ({\n      offer,\n      from\n    }) => {\n      const peer = addPeer(offer, from, myStream);\n      peersRef.current.push({\n        peerID: from,\n        peer\n      });\n      setPeers([...peersRef.current]);\n    });\n    socket.on(\"answer\", ({\n      answer,\n      from\n    }) => {\n      const item = peersRef.current.find(p => p.peerID === from);\n      if (item) {\n        item.peer.signal(answer);\n      }\n    });\n    socket.on(\"ice-candidate\", ({\n      candidate,\n      from\n    }) => {\n      const item = peersRef.current.find(p => p.peerID === from);\n      if (item) {\n        item.peer.signal(candidate);\n      }\n    });\n    socket.on(\"user-left\", ({\n      socketId,\n      participants\n    }) => {\n      const peerObj = peersRef.current.find(p => p.peerID === socketId);\n      if (peerObj) {\n        peerObj.peer.destroy();\n      }\n      peersRef.current = peersRef.current.filter(p => p.peerID !== socketId);\n      setPeers([...peersRef.current]);\n      setActiveSpeakers(prev => {\n        const newSet = new Set(prev);\n        newSet.delete(socketId);\n        return newSet;\n      });\n    });\n\n    // Chat events\n    socket.on(\"receive-message\", message => {\n      setMessages(prev => [...prev, message]);\n      setTimeout(() => {\n        var _chatEndRef$current;\n        return (_chatEndRef$current = chatEndRef.current) === null || _chatEndRef$current === void 0 ? void 0 : _chatEndRef$current.scrollIntoView({\n          behavior: \"smooth\"\n        });\n      }, 100);\n    });\n\n    // PDF events\n    socket.on(\"pdf-state\", pdfData => {\n      setPdfState(pdfData);\n      setShowPdf(true);\n    });\n    socket.on(\"pdf-page-update\", ({\n      currentPage\n    }) => {\n      setPdfState(prev => prev ? {\n        ...prev,\n        currentPage\n      } : null);\n    });\n    socket.on(\"pdf-removed\", () => {\n      setPdfState(null);\n      setShowPdf(false);\n    });\n\n    // Active speaker events\n    socket.on(\"user-speaking\", ({\n      socketId\n    }) => {\n      setActiveSpeakers(prev => new Set(prev).add(socketId));\n    });\n    socket.on(\"user-stopped-speaking\", ({\n      socketId\n    }) => {\n      setActiveSpeakers(prev => {\n        const newSet = new Set(prev);\n        newSet.delete(socketId);\n        return newSet;\n      });\n    });\n\n    // Screen sharing events\n    socket.on(\"screen-share-active\", ({\n      socketId\n    }) => {\n      console.log(\"Screen share started by:\", socketId);\n    });\n    socket.on(\"screen-share-ended\", () => {\n      console.log(\"Screen share ended\");\n    });\n\n    // Cleanup\n    return () => {\n      if (myStream) {\n        myStream.getTracks().forEach(track => track.stop());\n      }\n      if (screenStream) {\n        screenStream.getTracks().forEach(track => track.stop());\n      }\n      peersRef.current.forEach(({\n        peer\n      }) => peer.destroy());\n      socket.disconnect();\n    };\n  }, [roomId]);\n  function createPeer(userToSignal, callerID, stream) {\n    const peer = new Peer({\n      initiator: true,\n      trickle: false,\n      stream\n    });\n    peer.on(\"signal\", signal => {\n      socketRef.current.emit(\"offer\", {\n        roomId,\n        offer: signal,\n        to: userToSignal\n      });\n    });\n    peer.on(\"stream\", remoteStream => {\n      // Stream will be handled in the peer object\n    });\n    peersRef.current.push({\n      peerID: userToSignal,\n      peer\n    });\n    setPeers([...peersRef.current]);\n    return peer;\n  }\n  function addPeer(incomingSignal, callerID, stream) {\n    const peer = new Peer({\n      initiator: false,\n      trickle: false,\n      stream\n    });\n    peer.on(\"signal\", signal => {\n      socketRef.current.emit(\"answer\", {\n        roomId,\n        answer: signal,\n        to: callerID\n      });\n    });\n    peer.signal(incomingSignal);\n    return peer;\n  }\n  const loadChatHistory = async () => {\n    try {\n      const response = await axios.get(`${API_URL}/chat/${roomId}`);\n      setMessages(response.data.messages);\n      setTimeout(() => {\n        var _chatEndRef$current2;\n        return (_chatEndRef$current2 = chatEndRef.current) === null || _chatEndRef$current2 === void 0 ? void 0 : _chatEndRef$current2.scrollIntoView();\n      }, 100);\n    } catch (error) {\n      console.error(\"Error loading chat:\", error);\n    }\n  };\n  const sendMessage = e => {\n    e.preventDefault();\n    if (!newMessage.trim()) return;\n    socketRef.current.emit(\"send-message\", {\n      roomId,\n      userId: user.id,\n      userName: user.nombre,\n      texto: newMessage\n    });\n    setNewMessage(\"\");\n  };\n  const toggleAudio = () => {\n    if (myStream) {\n      const audioTrack = myStream.getAudioTracks()[0];\n      audioTrack.enabled = !audioTrack.enabled;\n      setAudioEnabled(audioTrack.enabled);\n      socketRef.current.emit(\"toggle-audio\", {\n        roomId,\n        userId: user.id,\n        audioEnabled: audioTrack.enabled\n      });\n    }\n  };\n  const toggleVideo = () => {\n    if (myStream) {\n      const videoTrack = myStream.getVideoTracks()[0];\n      videoTrack.enabled = !videoTrack.enabled;\n      setVideoEnabled(videoTrack.enabled);\n      socketRef.current.emit(\"toggle-video\", {\n        roomId,\n        userId: user.id,\n        videoEnabled: videoTrack.enabled\n      });\n    }\n  };\n  const handlePdfUpload = async e => {\n    const file = e.target.files[0];\n    if (!file || file.type !== \"application/pdf\") {\n      alert(\"Por favor selecciona un archivo PDF\");\n      return;\n    }\n    setUploadingPdf(true);\n    const formData = new FormData();\n    formData.append(\"pdf\", file);\n    formData.append(\"totalPages\", \"1\"); // Will be updated by backend if needed\n\n    try {\n      const response = await axios.post(`${API_URL}/pdf/upload/${roomId}`, formData, {\n        headers: {\n          \"Content-Type\": \"multipart/form-data\"\n        }\n      });\n      const pdfData = response.data.pdf;\n      socketRef.current.emit(\"pdf-uploaded\", {\n        roomId,\n        pdfData\n      });\n      setPdfState(pdfData);\n      setShowPdf(true);\n    } catch (error) {\n      console.error(\"Error uploading PDF:\", error);\n      alert(\"Error al subir PDF\");\n    } finally {\n      setUploadingPdf(false);\n    }\n  };\n  const changePdfPage = direction => {\n    if (!pdfState) return;\n    let newPage = pdfState.currentPage + direction;\n    if (newPage < 1) newPage = 1;\n    if (newPage > pdfState.totalPages) newPage = pdfState.totalPages;\n    socketRef.current.emit(\"pdf-page-changed\", {\n      roomId,\n      currentPage: newPage\n    });\n    setPdfState({\n      ...pdfState,\n      currentPage: newPage\n    });\n  };\n  const shareScreen = async () => {\n    if (!navigator.mediaDevices || !navigator.mediaDevices.getDisplayMedia) {\n      alert(\"Compartir pantalla requiere HTTPS o localhost\");\n      return;\n    }\n    try {\n      const stream = await navigator.mediaDevices.getDisplayMedia({\n        video: true,\n        audio: false\n      });\n      setScreenStream(stream);\n      socketRef.current.emit(\"screen-share-started\", {\n        roomId,\n        userId: user.id\n      });\n      stream.getVideoTracks()[0].onended = () => {\n        stopScreenShare();\n      };\n    } catch (error) {\n      console.error(\"Error sharing screen:\", error);\n      if (error.name === 'NotAllowedError') {\n        alert(\"Permiso denegado para compartir pantalla\");\n      }\n    }\n  };\n  const stopScreenShare = () => {\n    if (screenStream) {\n      screenStream.getTracks().forEach(track => track.stop());\n      setScreenStream(null);\n      socketRef.current.emit(\"screen-share-stopped\", {\n        roomId\n      });\n    }\n  };\n  const leaveRoom = () => {\n    if (myStream) {\n      myStream.getTracks().forEach(track => track.stop());\n    }\n    navigate(\"/\");\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: \"flex\",\n      height: \"100vh\",\n      background: \"var(--bg-primary)\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        flex: 1,\n        display: \"flex\",\n        flexDirection: \"column\",\n        padding: \"20px\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          marginBottom: \"20px\",\n          display: \"flex\",\n          justifyContent: \"space-between\",\n          alignItems: \"center\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          style: {\n            color: \"var(--text-secondary)\",\n            margin: 0\n          },\n          children: [\"Sala: \", /*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              color: \"var(--accent-primary)\"\n            },\n            children: roomId\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 438,\n            columnNumber: 19\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 437,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: \"flex\",\n            gap: \"10px\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowChat(!showChat),\n            className: \"btn\",\n            style: {\n              padding: \"8px 16px\",\n              fontSize: \"0.9rem\"\n            },\n            children: [showChat ? \"Ocultar\" : \"Mostrar\", \" Chat\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 441,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setShowPdf(!showPdf),\n            className: \"btn\",\n            style: {\n              padding: \"8px 16px\",\n              fontSize: \"0.9rem\"\n            },\n            children: [showPdf ? \"Ocultar\" : \"Mostrar\", \" PDF\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 448,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 440,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 436,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          flex: 1,\n          display: \"grid\",\n          gridTemplateColumns: peers.length === 0 ? \"1fr\" : peers.length === 1 ? \"1fr 1fr\" : \"repeat(auto-fit, minmax(300px, 1fr))\",\n          gap: \"15px\",\n          marginBottom: \"20px\",\n          overflow: \"auto\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            position: \"relative\",\n            background: \"#1a1a1a\",\n            borderRadius: \"12px\",\n            overflow: \"hidden\",\n            border: isSpeaking ? \"3px solid #10b981\" : \"3px solid transparent\",\n            transition: \"border 0.3s ease\",\n            boxShadow: isSpeaking ? \"0 0 20px rgba(16, 185, 129, 0.5)\" : \"none\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"video\", {\n            playsInline: true,\n            muted: true,\n            ref: myVideo,\n            autoPlay: true,\n            style: {\n              width: \"100%\",\n              height: \"100%\",\n              objectFit: \"cover\"\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 477,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              position: \"absolute\",\n              bottom: \"10px\",\n              left: \"10px\",\n              background: \"rgba(0,0,0,0.7)\",\n              padding: \"5px 10px\",\n              borderRadius: \"6px\",\n              color: \"white\",\n              fontSize: \"0.9rem\"\n            },\n            children: [user === null || user === void 0 ? void 0 : user.nombre, \" (T\\xFA)\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 484,\n            columnNumber: 13\n          }, this), !audioEnabled && /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              position: \"absolute\",\n              top: \"10px\",\n              right: \"10px\",\n              background: \"rgba(239, 68, 68, 0.9)\",\n              padding: \"5px 10px\",\n              borderRadius: \"6px\",\n              color: \"white\",\n              fontSize: \"0.8rem\"\n            },\n            children: \"\\uD83D\\uDD07 Muted\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 497,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 468,\n          columnNumber: 11\n        }, this), peers.map(({\n          peerID,\n          peer\n        }) => /*#__PURE__*/_jsxDEV(VideoCard, {\n          peer: peer,\n          peerID: peerID,\n          isActive: activeSpeakers.has(peerID)\n        }, peerID, false, {\n          fileName: _jsxFileName,\n          lineNumber: 514,\n          columnNumber: 13\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 459,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: \"flex\",\n          justifyContent: \"center\",\n          gap: \"15px\",\n          padding: \"15px\",\n          background: \"rgba(255,255,255,0.05)\",\n          borderRadius: \"12px\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: toggleAudio,\n          style: {\n            padding: \"12px 20px\",\n            borderRadius: \"8px\",\n            border: \"none\",\n            background: audioEnabled ? \"var(--accent-primary)\" : \"#ef4444\",\n            color: \"white\",\n            cursor: \"pointer\",\n            fontSize: \"1rem\",\n            fontWeight: \"500\"\n          },\n          children: audioEnabled ? \"ðŸŽ¤ MicrÃ³fono\" : \"ðŸ”‡ Mutear\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 532,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: toggleVideo,\n          style: {\n            padding: \"12px 20px\",\n            borderRadius: \"8px\",\n            border: \"none\",\n            background: videoEnabled ? \"var(--accent-primary)\" : \"#ef4444\",\n            color: \"white\",\n            cursor: \"pointer\",\n            fontSize: \"1rem\",\n            fontWeight: \"500\"\n          },\n          children: videoEnabled ? \"ðŸ“¹ CÃ¡mara\" : \"ðŸ“· Sin Video\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 547,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: screenStream ? stopScreenShare : shareScreen,\n          style: {\n            padding: \"12px 20px\",\n            borderRadius: \"8px\",\n            border: \"none\",\n            background: screenStream ? \"#ef4444\" : \"var(--accent-secondary)\",\n            color: \"white\",\n            cursor: \"pointer\",\n            fontSize: \"1rem\",\n            fontWeight: \"500\"\n          },\n          children: screenStream ? \"â¹ï¸ Detener\" : \"ðŸ–¥ï¸ Compartir Pantalla\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 562,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => {\n            var _fileInputRef$current;\n            return (_fileInputRef$current = fileInputRef.current) === null || _fileInputRef$current === void 0 ? void 0 : _fileInputRef$current.click();\n          },\n          disabled: uploadingPdf,\n          style: {\n            padding: \"12px 20px\",\n            borderRadius: \"8px\",\n            border: \"none\",\n            background: \"#8b5cf6\",\n            color: \"white\",\n            cursor: uploadingPdf ? \"not-allowed\" : \"pointer\",\n            fontSize: \"1rem\",\n            fontWeight: \"500\"\n          },\n          children: uploadingPdf ? \"Subiendo...\" : \"ðŸ“„ Subir PDF\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 577,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          ref: fileInputRef,\n          type: \"file\",\n          accept: \"application/pdf\",\n          onChange: handlePdfUpload,\n          style: {\n            display: \"none\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 593,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: leaveRoom,\n          style: {\n            padding: \"12px 20px\",\n            borderRadius: \"8px\",\n            border: \"none\",\n            background: \"#dc2626\",\n            color: \"white\",\n            cursor: \"pointer\",\n            fontSize: \"1rem\",\n            fontWeight: \"500\"\n          },\n          children: \"\\uD83D\\uDEAA Salir\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 600,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 524,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 434,\n      columnNumber: 7\n    }, this), showChat && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        width: \"350px\",\n        background: \"rgba(255,255,255,0.03)\",\n        borderLeft: \"1px solid rgba(255,255,255,0.1)\",\n        display: \"flex\",\n        flexDirection: \"column\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          padding: \"20px\",\n          borderBottom: \"1px solid rgba(255,255,255,0.1)\"\n        },\n        children: /*#__PURE__*/_jsxDEV(\"h3\", {\n          style: {\n            margin: 0,\n            color: \"var(--text-primary)\"\n          },\n          children: \"Chat\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 631,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 627,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          flex: 1,\n          overflowY: \"auto\",\n          padding: \"15px\",\n          display: \"flex\",\n          flexDirection: \"column\",\n          gap: \"10px\"\n        },\n        children: [messages.map((msg, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            background: msg.userId === user.id ? \"rgba(96, 165, 250, 0.2)\" : \"rgba(255,255,255,0.05)\",\n            padding: \"10px\",\n            borderRadius: \"8px\",\n            alignSelf: msg.userId === user.id ? \"flex-end\" : \"flex-start\",\n            maxWidth: \"80%\"\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: \"0.8rem\",\n              color: \"var(--accent-primary)\",\n              marginBottom: \"3px\"\n            },\n            children: msg.userName\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 649,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              color: \"var(--text-primary)\"\n            },\n            children: msg.texto\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 652,\n            columnNumber: 17\n          }, this)]\n        }, idx, true, {\n          fileName: _jsxFileName,\n          lineNumber: 642,\n          columnNumber: 15\n        }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n          ref: chatEndRef\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 655,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 633,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: sendMessage,\n        style: {\n          padding: \"15px\",\n          borderTop: \"1px solid rgba(255,255,255,0.1)\",\n          display: \"flex\",\n          gap: \"10px\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          value: newMessage,\n          onChange: e => setNewMessage(e.target.value),\n          placeholder: \"Escribe un mensaje...\",\n          style: {\n            flex: 1,\n            padding: \"10px\",\n            borderRadius: \"8px\",\n            border: \"1px solid rgba(255,255,255,0.1)\",\n            background: \"rgba(255,255,255,0.05)\",\n            color: \"var(--text-primary)\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 663,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          className: \"btn\",\n          style: {\n            padding: \"10px 20px\"\n          },\n          children: \"Enviar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 677,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 657,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 620,\n      columnNumber: 9\n    }, this), showPdf && pdfState && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        width: \"400px\",\n        background: \"rgba(255,255,255,0.03)\",\n        borderLeft: \"1px solid rgba(255,255,255,0.1)\",\n        display: \"flex\",\n        flexDirection: \"column\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          padding: \"20px\",\n          borderBottom: \"1px solid rgba(255,255,255,0.1)\"\n        },\n        children: /*#__PURE__*/_jsxDEV(\"h3\", {\n          style: {\n            margin: 0,\n            color: \"var(--text-primary)\"\n          },\n          children: \"PDF Compartido\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 697,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 693,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          flex: 1,\n          display: \"flex\",\n          alignItems: \"center\",\n          justifyContent: \"center\",\n          padding: \"20px\",\n          background: \"#2a2a2a\"\n        },\n        children: /*#__PURE__*/_jsxDEV(\"iframe\", {\n          src: `${API_URL}/pdf/file/${pdfState.filename}#page=${pdfState.currentPage}`,\n          style: {\n            width: \"100%\",\n            height: \"100%\",\n            border: \"none\"\n          },\n          title: \"PDF Viewer\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 707,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 699,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          padding: \"15px\",\n          borderTop: \"1px solid rgba(255,255,255,0.1)\",\n          display: \"flex\",\n          justifyContent: \"space-between\",\n          alignItems: \"center\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => changePdfPage(-1),\n          disabled: pdfState.currentPage === 1,\n          className: \"btn\",\n          style: {\n            padding: \"8px 16px\"\n          },\n          children: \"\\u2190 Anterior\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 720,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          style: {\n            color: \"var(--text-primary)\"\n          },\n          children: [pdfState.currentPage, \" / \", pdfState.totalPages]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 728,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => changePdfPage(1),\n          disabled: pdfState.currentPage === pdfState.totalPages,\n          className: \"btn\",\n          style: {\n            padding: \"8px 16px\"\n          },\n          children: \"Siguiente \\u2192\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 731,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 713,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 686,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 432,\n    columnNumber: 5\n  }, this);\n}\n_s(Room, \"vEQUlr7WG46I5k8SHCxmF7jWMGA=\", false, function () {\n  return [useParams, useAuth, useNavigate, useAudioLevel];\n});\n_c = Room;\nfunction VideoCard({\n  peer,\n  peerID,\n  isActive\n}) {\n  _s2();\n  const ref = useRef();\n  useEffect(() => {\n    peer.on(\"stream\", stream => {\n      if (ref.current) {\n        ref.current.srcObject = stream;\n      }\n    });\n  }, [peer]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      position: \"relative\",\n      background: \"#1a1a1a\",\n      borderRadius: \"12px\",\n      overflow: \"hidden\",\n      border: isActive ? \"3px solid #10b981\" : \"3px solid transparent\",\n      transition: \"border 0.3s ease\",\n      boxShadow: isActive ? \"0 0 20px rgba(16, 185, 129, 0.5)\" : \"none\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"video\", {\n      playsInline: true,\n      autoPlay: true,\n      ref: ref,\n      style: {\n        width: \"100%\",\n        height: \"100%\",\n        objectFit: \"cover\"\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 767,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: \"absolute\",\n        bottom: \"10px\",\n        left: \"10px\",\n        background: \"rgba(0,0,0,0.7)\",\n        padding: \"5px 10px\",\n        borderRadius: \"6px\",\n        color: \"white\",\n        fontSize: \"0.9rem\"\n      },\n      children: \"Participante\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 773,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 758,\n    columnNumber: 5\n  }, this);\n}\n_s2(VideoCard, \"8uVE59eA/r6b92xF80p7sH8rXLk=\");\n_c2 = VideoCard;\nexport default Room;\nvar _c, _c2;\n$RefreshReg$(_c, \"Room\");\n$RefreshReg$(_c2, \"VideoCard\");","map":{"version":3,"names":["React","useEffect","useRef","useState","useParams","useNavigate","Peer","io","useAuth","useAudioLevel","axios","jsxDEV","_jsxDEV","Room","_s","roomId","user","navigate","myStream","setMyStream","peers","setPeers","screenStream","setScreenStream","audioEnabled","setAudioEnabled","videoEnabled","setVideoEnabled","showChat","setShowChat","showPdf","setShowPdf","messages","setMessages","newMessage","setNewMessage","pdfState","setPdfState","uploadingPdf","setUploadingPdf","activeSpeakers","setActiveSpeakers","Set","myVideo","socketRef","peersRef","chatEndRef","fileInputRef","host","window","location","hostname","API_URL","protocol","isSpeaking","_socketRef$current","current","emit","userId","id","userName","nombre","_socketRef$current2","navigator","mediaDevices","getUserMedia","alert","href","connect","socket","loadChatHistory","video","audio","then","currentStream","srcObject","catch","err","console","error","on","participants","log","forEach","participant","socketId","createPeer","newUserId","offer","from","peer","addPeer","push","peerID","answer","item","find","p","signal","candidate","peerObj","destroy","filter","prev","newSet","delete","message","setTimeout","_chatEndRef$current","scrollIntoView","behavior","pdfData","currentPage","add","getTracks","track","stop","disconnect","userToSignal","callerID","stream","initiator","trickle","to","remoteStream","incomingSignal","response","get","data","_chatEndRef$current2","sendMessage","e","preventDefault","trim","texto","toggleAudio","audioTrack","getAudioTracks","enabled","toggleVideo","videoTrack","getVideoTracks","handlePdfUpload","file","target","files","type","formData","FormData","append","post","headers","pdf","changePdfPage","direction","newPage","totalPages","shareScreen","getDisplayMedia","onended","stopScreenShare","name","leaveRoom","style","display","height","background","children","flex","flexDirection","padding","marginBottom","justifyContent","alignItems","color","margin","fileName","_jsxFileName","lineNumber","columnNumber","gap","onClick","className","fontSize","gridTemplateColumns","length","overflow","position","borderRadius","border","transition","boxShadow","playsInline","muted","ref","autoPlay","width","objectFit","bottom","left","top","right","map","VideoCard","isActive","has","cursor","fontWeight","_fileInputRef$current","click","disabled","accept","onChange","borderLeft","borderBottom","overflowY","msg","idx","alignSelf","maxWidth","onSubmit","borderTop","value","placeholder","src","filename","title","_c","_s2","_c2","$RefreshReg$"],"sources":["/home/cristian/Documentos/7mo/lenguajes_programacion/Videoconferencia-app/client/src/pages/Room.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport Peer from \"simple-peer\";\nimport io from \"socket.io-client\";\nimport { useAuth } from \"../context/AuthContext\";\nimport { useAudioLevel } from \"../hooks/useAudioLevel\";\nimport axios from \"axios\";\n\nfunction Room() {\n  const { roomId } = useParams();\n  const { user } = useAuth();\n  const navigate = useNavigate();\n\n  // Media streams\n  const [myStream, setMyStream] = useState(null);\n  const [peers, setPeers] = useState([]);\n  const [screenStream, setScreenStream] = useState(null);\n\n  // UI state\n  const [audioEnabled, setAudioEnabled] = useState(true);\n  const [videoEnabled, setVideoEnabled] = useState(true);\n  const [showChat, setShowChat] = useState(true);\n  const [showPdf, setShowPdf] = useState(false);\n\n  // Chat\n  const [messages, setMessages] = useState([]);\n  const [newMessage, setNewMessage] = useState(\"\");\n\n  // PDF\n  const [pdfState, setPdfState] = useState(null);\n  const [uploadingPdf, setUploadingPdf] = useState(false);\n\n  // Active speakers\n  const [activeSpeakers, setActiveSpeakers] = useState(new Set());\n\n  // Refs\n  const myVideo = useRef();\n  const socketRef = useRef();\n  const peersRef = useRef([]);\n  const chatEndRef = useRef();\n  const fileInputRef = useRef();\n\n  const host = window.location.hostname;\n  const API_URL = `${window.location.protocol}//${host}:5000/api`;\n\n  // Detect if I'm speaking\n  const isSpeaking = useAudioLevel(myStream);\n\n  useEffect(() => {\n    if (isSpeaking) {\n      socketRef.current?.emit(\"user-speaking\", {\n        roomId,\n        userId: user.id,\n        userName: user.nombre\n      });\n    } else {\n      socketRef.current?.emit(\"user-stopped-speaking\", {\n        roomId,\n        userId: user.id\n      });\n    }\n  }, [isSpeaking]);\n\n  useEffect(() => {\n    // Check if mediaDevices is available (requires HTTPS or localhost)\n    if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {\n      alert(\n        \"âš ï¸ WebRTC no estÃ¡ disponible.\\n\\n\" +\n        \"Para usar video/audio, debes acceder desde:\\n\" +\n        \"â€¢ http://localhost:3000 (en este equipo)\\n\" +\n        \"â€¢ https://... (conexiÃ³n segura)\\n\\n\" +\n        \"Actualmente estÃ¡s en: \" + window.location.href + \"\\n\\n\" +\n        \"El chat y PDF funcionarÃ¡n, pero no el video.\"\n      );\n      // Continue without video/audio\n      socketRef.current = io.connect(`http://${host}:5000`);\n      const socket = socketRef.current;\n\n      socket.emit(\"join-room\", {\n        roomId,\n        userId: user.id,\n        userName: user.nombre\n      });\n\n      loadChatHistory();\n      return;\n    }\n\n    // Initialize socket\n    socketRef.current = io.connect(`http://${host}:5000`);\n    const socket = socketRef.current;\n\n    // Get user media\n    navigator.mediaDevices\n      .getUserMedia({ video: true, audio: true })\n      .then((currentStream) => {\n        setMyStream(currentStream);\n        if (myVideo.current) {\n          myVideo.current.srcObject = currentStream;\n        }\n\n        // Join room\n        socket.emit(\"join-room\", {\n          roomId,\n          userId: user.id,\n          userName: user.nombre\n        });\n\n        // Load chat history\n        loadChatHistory();\n      })\n      .catch((err) => {\n        console.error(\"Error accessing media devices:\", err);\n        alert(\n          \"No se pudo acceder a la cÃ¡mara o micrÃ³fono.\\n\\n\" +\n          \"Posibles causas:\\n\" +\n          \"â€¢ Permisos denegados\\n\" +\n          \"â€¢ CÃ¡mara/micrÃ³fono en uso por otra app\\n\" +\n          \"â€¢ Dispositivos no disponibles\\n\\n\" +\n          \"El chat y PDF funcionarÃ¡n normalmente.\"\n        );\n\n        // Continue without video/audio\n        socket.emit(\"join-room\", {\n          roomId,\n          userId: user.id,\n          userName: user.nombre\n        });\n\n        loadChatHistory();\n      });\n\n    // Socket event listeners\n    socket.on(\"room-participants\", (participants) => {\n      console.log(\"Current participants:\", participants);\n      // Create peers for existing participants\n      participants.forEach((participant) => {\n        if (participant.socketId !== socket.id && participant.socketId) {\n          createPeer(participant.socketId, socket.id, myStream);\n        }\n      });\n    });\n\n    socket.on(\"user-joined\", ({ userId: newUserId, userName, participants }) => {\n      console.log(`${userName} joined`);\n      // The new user will initiate the connection\n    });\n\n    socket.on(\"offer\", ({ offer, from }) => {\n      const peer = addPeer(offer, from, myStream);\n      peersRef.current.push({\n        peerID: from,\n        peer\n      });\n      setPeers([...peersRef.current]);\n    });\n\n    socket.on(\"answer\", ({ answer, from }) => {\n      const item = peersRef.current.find((p) => p.peerID === from);\n      if (item) {\n        item.peer.signal(answer);\n      }\n    });\n\n    socket.on(\"ice-candidate\", ({ candidate, from }) => {\n      const item = peersRef.current.find((p) => p.peerID === from);\n      if (item) {\n        item.peer.signal(candidate);\n      }\n    });\n\n    socket.on(\"user-left\", ({ socketId, participants }) => {\n      const peerObj = peersRef.current.find((p) => p.peerID === socketId);\n      if (peerObj) {\n        peerObj.peer.destroy();\n      }\n      peersRef.current = peersRef.current.filter((p) => p.peerID !== socketId);\n      setPeers([...peersRef.current]);\n\n      setActiveSpeakers(prev => {\n        const newSet = new Set(prev);\n        newSet.delete(socketId);\n        return newSet;\n      });\n    });\n\n    // Chat events\n    socket.on(\"receive-message\", (message) => {\n      setMessages((prev) => [...prev, message]);\n      setTimeout(() => chatEndRef.current?.scrollIntoView({ behavior: \"smooth\" }), 100);\n    });\n\n    // PDF events\n    socket.on(\"pdf-state\", (pdfData) => {\n      setPdfState(pdfData);\n      setShowPdf(true);\n    });\n\n    socket.on(\"pdf-page-update\", ({ currentPage }) => {\n      setPdfState((prev) => prev ? { ...prev, currentPage } : null);\n    });\n\n    socket.on(\"pdf-removed\", () => {\n      setPdfState(null);\n      setShowPdf(false);\n    });\n\n    // Active speaker events\n    socket.on(\"user-speaking\", ({ socketId }) => {\n      setActiveSpeakers(prev => new Set(prev).add(socketId));\n    });\n\n    socket.on(\"user-stopped-speaking\", ({ socketId }) => {\n      setActiveSpeakers(prev => {\n        const newSet = new Set(prev);\n        newSet.delete(socketId);\n        return newSet;\n      });\n    });\n\n    // Screen sharing events\n    socket.on(\"screen-share-active\", ({ socketId }) => {\n      console.log(\"Screen share started by:\", socketId);\n    });\n\n    socket.on(\"screen-share-ended\", () => {\n      console.log(\"Screen share ended\");\n    });\n\n    // Cleanup\n    return () => {\n      if (myStream) {\n        myStream.getTracks().forEach((track) => track.stop());\n      }\n      if (screenStream) {\n        screenStream.getTracks().forEach((track) => track.stop());\n      }\n      peersRef.current.forEach(({ peer }) => peer.destroy());\n      socket.disconnect();\n    };\n  }, [roomId]);\n\n  function createPeer(userToSignal, callerID, stream) {\n    const peer = new Peer({\n      initiator: true,\n      trickle: false,\n      stream\n    });\n\n    peer.on(\"signal\", (signal) => {\n      socketRef.current.emit(\"offer\", {\n        roomId,\n        offer: signal,\n        to: userToSignal\n      });\n    });\n\n    peer.on(\"stream\", (remoteStream) => {\n      // Stream will be handled in the peer object\n    });\n\n    peersRef.current.push({\n      peerID: userToSignal,\n      peer\n    });\n    setPeers([...peersRef.current]);\n\n    return peer;\n  }\n\n  function addPeer(incomingSignal, callerID, stream) {\n    const peer = new Peer({\n      initiator: false,\n      trickle: false,\n      stream\n    });\n\n    peer.on(\"signal\", (signal) => {\n      socketRef.current.emit(\"answer\", {\n        roomId,\n        answer: signal,\n        to: callerID\n      });\n    });\n\n    peer.signal(incomingSignal);\n\n    return peer;\n  }\n\n  const loadChatHistory = async () => {\n    try {\n      const response = await axios.get(`${API_URL}/chat/${roomId}`);\n      setMessages(response.data.messages);\n      setTimeout(() => chatEndRef.current?.scrollIntoView(), 100);\n    } catch (error) {\n      console.error(\"Error loading chat:\", error);\n    }\n  };\n\n  const sendMessage = (e) => {\n    e.preventDefault();\n    if (!newMessage.trim()) return;\n\n    socketRef.current.emit(\"send-message\", {\n      roomId,\n      userId: user.id,\n      userName: user.nombre,\n      texto: newMessage\n    });\n\n    setNewMessage(\"\");\n  };\n\n  const toggleAudio = () => {\n    if (myStream) {\n      const audioTrack = myStream.getAudioTracks()[0];\n      audioTrack.enabled = !audioTrack.enabled;\n      setAudioEnabled(audioTrack.enabled);\n\n      socketRef.current.emit(\"toggle-audio\", {\n        roomId,\n        userId: user.id,\n        audioEnabled: audioTrack.enabled\n      });\n    }\n  };\n\n  const toggleVideo = () => {\n    if (myStream) {\n      const videoTrack = myStream.getVideoTracks()[0];\n      videoTrack.enabled = !videoTrack.enabled;\n      setVideoEnabled(videoTrack.enabled);\n\n      socketRef.current.emit(\"toggle-video\", {\n        roomId,\n        userId: user.id,\n        videoEnabled: videoTrack.enabled\n      });\n    }\n  };\n\n  const handlePdfUpload = async (e) => {\n    const file = e.target.files[0];\n    if (!file || file.type !== \"application/pdf\") {\n      alert(\"Por favor selecciona un archivo PDF\");\n      return;\n    }\n\n    setUploadingPdf(true);\n    const formData = new FormData();\n    formData.append(\"pdf\", file);\n    formData.append(\"totalPages\", \"1\"); // Will be updated by backend if needed\n\n    try {\n      const response = await axios.post(\n        `${API_URL}/pdf/upload/${roomId}`,\n        formData,\n        {\n          headers: { \"Content-Type\": \"multipart/form-data\" }\n        }\n      );\n\n      const pdfData = response.data.pdf;\n      socketRef.current.emit(\"pdf-uploaded\", { roomId, pdfData });\n      setPdfState(pdfData);\n      setShowPdf(true);\n    } catch (error) {\n      console.error(\"Error uploading PDF:\", error);\n      alert(\"Error al subir PDF\");\n    } finally {\n      setUploadingPdf(false);\n    }\n  };\n\n  const changePdfPage = (direction) => {\n    if (!pdfState) return;\n\n    let newPage = pdfState.currentPage + direction;\n    if (newPage < 1) newPage = 1;\n    if (newPage > pdfState.totalPages) newPage = pdfState.totalPages;\n\n    socketRef.current.emit(\"pdf-page-changed\", { roomId, currentPage: newPage });\n    setPdfState({ ...pdfState, currentPage: newPage });\n  };\n\n  const shareScreen = async () => {\n    if (!navigator.mediaDevices || !navigator.mediaDevices.getDisplayMedia) {\n      alert(\"Compartir pantalla requiere HTTPS o localhost\");\n      return;\n    }\n\n    try {\n      const stream = await navigator.mediaDevices.getDisplayMedia({\n        video: true,\n        audio: false\n      });\n\n      setScreenStream(stream);\n      socketRef.current.emit(\"screen-share-started\", {\n        roomId,\n        userId: user.id\n      });\n\n      stream.getVideoTracks()[0].onended = () => {\n        stopScreenShare();\n      };\n    } catch (error) {\n      console.error(\"Error sharing screen:\", error);\n      if (error.name === 'NotAllowedError') {\n        alert(\"Permiso denegado para compartir pantalla\");\n      }\n    }\n  };\n\n  const stopScreenShare = () => {\n    if (screenStream) {\n      screenStream.getTracks().forEach((track) => track.stop());\n      setScreenStream(null);\n      socketRef.current.emit(\"screen-share-stopped\", { roomId });\n    }\n  };\n\n  const leaveRoom = () => {\n    if (myStream) {\n      myStream.getTracks().forEach((track) => track.stop());\n    }\n    navigate(\"/\");\n  };\n\n  return (\n    <div style={{ display: \"flex\", height: \"100vh\", background: \"var(--bg-primary)\" }}>\n      {/* Main video area */}\n      <div style={{ flex: 1, display: \"flex\", flexDirection: \"column\", padding: \"20px\" }}>\n        {/* Header */}\n        <div style={{ marginBottom: \"20px\", display: \"flex\", justifyContent: \"space-between\", alignItems: \"center\" }}>\n          <h2 style={{ color: \"var(--text-secondary)\", margin: 0 }}>\n            Sala: <span style={{ color: \"var(--accent-primary)\" }}>{roomId}</span>\n          </h2>\n          <div style={{ display: \"flex\", gap: \"10px\" }}>\n            <button\n              onClick={() => setShowChat(!showChat)}\n              className=\"btn\"\n              style={{ padding: \"8px 16px\", fontSize: \"0.9rem\" }}\n            >\n              {showChat ? \"Ocultar\" : \"Mostrar\"} Chat\n            </button>\n            <button\n              onClick={() => setShowPdf(!showPdf)}\n              className=\"btn\"\n              style={{ padding: \"8px 16px\", fontSize: \"0.9rem\" }}\n            >\n              {showPdf ? \"Ocultar\" : \"Mostrar\"} PDF\n            </button>\n          </div>\n        </div>\n\n        {/* Video grid */}\n        <div style={{\n          flex: 1,\n          display: \"grid\",\n          gridTemplateColumns: peers.length === 0 ? \"1fr\" : peers.length === 1 ? \"1fr 1fr\" : \"repeat(auto-fit, minmax(300px, 1fr))\",\n          gap: \"15px\",\n          marginBottom: \"20px\",\n          overflow: \"auto\"\n        }}>\n          {/* My video */}\n          <div style={{\n            position: \"relative\",\n            background: \"#1a1a1a\",\n            borderRadius: \"12px\",\n            overflow: \"hidden\",\n            border: isSpeaking ? \"3px solid #10b981\" : \"3px solid transparent\",\n            transition: \"border 0.3s ease\",\n            boxShadow: isSpeaking ? \"0 0 20px rgba(16, 185, 129, 0.5)\" : \"none\"\n          }}>\n            <video\n              playsInline\n              muted\n              ref={myVideo}\n              autoPlay\n              style={{ width: \"100%\", height: \"100%\", objectFit: \"cover\" }}\n            />\n            <div style={{\n              position: \"absolute\",\n              bottom: \"10px\",\n              left: \"10px\",\n              background: \"rgba(0,0,0,0.7)\",\n              padding: \"5px 10px\",\n              borderRadius: \"6px\",\n              color: \"white\",\n              fontSize: \"0.9rem\"\n            }}>\n              {user?.nombre} (TÃº)\n            </div>\n            {!audioEnabled && (\n              <div style={{\n                position: \"absolute\",\n                top: \"10px\",\n                right: \"10px\",\n                background: \"rgba(239, 68, 68, 0.9)\",\n                padding: \"5px 10px\",\n                borderRadius: \"6px\",\n                color: \"white\",\n                fontSize: \"0.8rem\"\n              }}>\n                ðŸ”‡ Muted\n              </div>\n            )}\n          </div>\n\n          {/* Peer videos */}\n          {peers.map(({ peerID, peer }) => (\n            <VideoCard\n              key={peerID}\n              peer={peer}\n              peerID={peerID}\n              isActive={activeSpeakers.has(peerID)}\n            />\n          ))}\n        </div>\n\n        {/* Control bar */}\n        <div style={{\n          display: \"flex\",\n          justifyContent: \"center\",\n          gap: \"15px\",\n          padding: \"15px\",\n          background: \"rgba(255,255,255,0.05)\",\n          borderRadius: \"12px\"\n        }}>\n          <button\n            onClick={toggleAudio}\n            style={{\n              padding: \"12px 20px\",\n              borderRadius: \"8px\",\n              border: \"none\",\n              background: audioEnabled ? \"var(--accent-primary)\" : \"#ef4444\",\n              color: \"white\",\n              cursor: \"pointer\",\n              fontSize: \"1rem\",\n              fontWeight: \"500\"\n            }}\n          >\n            {audioEnabled ? \"ðŸŽ¤ MicrÃ³fono\" : \"ðŸ”‡ Mutear\"}\n          </button>\n          <button\n            onClick={toggleVideo}\n            style={{\n              padding: \"12px 20px\",\n              borderRadius: \"8px\",\n              border: \"none\",\n              background: videoEnabled ? \"var(--accent-primary)\" : \"#ef4444\",\n              color: \"white\",\n              cursor: \"pointer\",\n              fontSize: \"1rem\",\n              fontWeight: \"500\"\n            }}\n          >\n            {videoEnabled ? \"ðŸ“¹ CÃ¡mara\" : \"ðŸ“· Sin Video\"}\n          </button>\n          <button\n            onClick={screenStream ? stopScreenShare : shareScreen}\n            style={{\n              padding: \"12px 20px\",\n              borderRadius: \"8px\",\n              border: \"none\",\n              background: screenStream ? \"#ef4444\" : \"var(--accent-secondary)\",\n              color: \"white\",\n              cursor: \"pointer\",\n              fontSize: \"1rem\",\n              fontWeight: \"500\"\n            }}\n          >\n            {screenStream ? \"â¹ï¸ Detener\" : \"ðŸ–¥ï¸ Compartir Pantalla\"}\n          </button>\n          <button\n            onClick={() => fileInputRef.current?.click()}\n            disabled={uploadingPdf}\n            style={{\n              padding: \"12px 20px\",\n              borderRadius: \"8px\",\n              border: \"none\",\n              background: \"#8b5cf6\",\n              color: \"white\",\n              cursor: uploadingPdf ? \"not-allowed\" : \"pointer\",\n              fontSize: \"1rem\",\n              fontWeight: \"500\"\n            }}\n          >\n            {uploadingPdf ? \"Subiendo...\" : \"ðŸ“„ Subir PDF\"}\n          </button>\n          <input\n            ref={fileInputRef}\n            type=\"file\"\n            accept=\"application/pdf\"\n            onChange={handlePdfUpload}\n            style={{ display: \"none\" }}\n          />\n          <button\n            onClick={leaveRoom}\n            style={{\n              padding: \"12px 20px\",\n              borderRadius: \"8px\",\n              border: \"none\",\n              background: \"#dc2626\",\n              color: \"white\",\n              cursor: \"pointer\",\n              fontSize: \"1rem\",\n              fontWeight: \"500\"\n            }}\n          >\n            ðŸšª Salir\n          </button>\n        </div>\n      </div>\n\n      {/* Chat panel */}\n      {showChat && (\n        <div style={{\n          width: \"350px\",\n          background: \"rgba(255,255,255,0.03)\",\n          borderLeft: \"1px solid rgba(255,255,255,0.1)\",\n          display: \"flex\",\n          flexDirection: \"column\"\n        }}>\n          <div style={{\n            padding: \"20px\",\n            borderBottom: \"1px solid rgba(255,255,255,0.1)\"\n          }}>\n            <h3 style={{ margin: 0, color: \"var(--text-primary)\" }}>Chat</h3>\n          </div>\n          <div style={{\n            flex: 1,\n            overflowY: \"auto\",\n            padding: \"15px\",\n            display: \"flex\",\n            flexDirection: \"column\",\n            gap: \"10px\"\n          }}>\n            {messages.map((msg, idx) => (\n              <div key={idx} style={{\n                background: msg.userId === user.id ? \"rgba(96, 165, 250, 0.2)\" : \"rgba(255,255,255,0.05)\",\n                padding: \"10px\",\n                borderRadius: \"8px\",\n                alignSelf: msg.userId === user.id ? \"flex-end\" : \"flex-start\",\n                maxWidth: \"80%\"\n              }}>\n                <div style={{ fontSize: \"0.8rem\", color: \"var(--accent-primary)\", marginBottom: \"3px\" }}>\n                  {msg.userName}\n                </div>\n                <div style={{ color: \"var(--text-primary)\" }}>{msg.texto}</div>\n              </div>\n            ))}\n            <div ref={chatEndRef} />\n          </div>\n          <form onSubmit={sendMessage} style={{\n            padding: \"15px\",\n            borderTop: \"1px solid rgba(255,255,255,0.1)\",\n            display: \"flex\",\n            gap: \"10px\"\n          }}>\n            <input\n              type=\"text\"\n              value={newMessage}\n              onChange={(e) => setNewMessage(e.target.value)}\n              placeholder=\"Escribe un mensaje...\"\n              style={{\n                flex: 1,\n                padding: \"10px\",\n                borderRadius: \"8px\",\n                border: \"1px solid rgba(255,255,255,0.1)\",\n                background: \"rgba(255,255,255,0.05)\",\n                color: \"var(--text-primary)\"\n              }}\n            />\n            <button type=\"submit\" className=\"btn\" style={{ padding: \"10px 20px\" }}>\n              Enviar\n            </button>\n          </form>\n        </div>\n      )}\n\n      {/* PDF panel */}\n      {showPdf && pdfState && (\n        <div style={{\n          width: \"400px\",\n          background: \"rgba(255,255,255,0.03)\",\n          borderLeft: \"1px solid rgba(255,255,255,0.1)\",\n          display: \"flex\",\n          flexDirection: \"column\"\n        }}>\n          <div style={{\n            padding: \"20px\",\n            borderBottom: \"1px solid rgba(255,255,255,0.1)\"\n          }}>\n            <h3 style={{ margin: 0, color: \"var(--text-primary)\" }}>PDF Compartido</h3>\n          </div>\n          <div style={{\n            flex: 1,\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"center\",\n            padding: \"20px\",\n            background: \"#2a2a2a\"\n          }}>\n            <iframe\n              src={`${API_URL}/pdf/file/${pdfState.filename}#page=${pdfState.currentPage}`}\n              style={{ width: \"100%\", height: \"100%\", border: \"none\" }}\n              title=\"PDF Viewer\"\n            />\n          </div>\n          <div style={{\n            padding: \"15px\",\n            borderTop: \"1px solid rgba(255,255,255,0.1)\",\n            display: \"flex\",\n            justifyContent: \"space-between\",\n            alignItems: \"center\"\n          }}>\n            <button\n              onClick={() => changePdfPage(-1)}\n              disabled={pdfState.currentPage === 1}\n              className=\"btn\"\n              style={{ padding: \"8px 16px\" }}\n            >\n              â† Anterior\n            </button>\n            <span style={{ color: \"var(--text-primary)\" }}>\n              {pdfState.currentPage} / {pdfState.totalPages}\n            </span>\n            <button\n              onClick={() => changePdfPage(1)}\n              disabled={pdfState.currentPage === pdfState.totalPages}\n              className=\"btn\"\n              style={{ padding: \"8px 16px\" }}\n            >\n              Siguiente â†’\n            </button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\nfunction VideoCard({ peer, peerID, isActive }) {\n  const ref = useRef();\n\n  useEffect(() => {\n    peer.on(\"stream\", (stream) => {\n      if (ref.current) {\n        ref.current.srcObject = stream;\n      }\n    });\n  }, [peer]);\n\n  return (\n    <div style={{\n      position: \"relative\",\n      background: \"#1a1a1a\",\n      borderRadius: \"12px\",\n      overflow: \"hidden\",\n      border: isActive ? \"3px solid #10b981\" : \"3px solid transparent\",\n      transition: \"border 0.3s ease\",\n      boxShadow: isActive ? \"0 0 20px rgba(16, 185, 129, 0.5)\" : \"none\"\n    }}>\n      <video\n        playsInline\n        autoPlay\n        ref={ref}\n        style={{ width: \"100%\", height: \"100%\", objectFit: \"cover\" }}\n      />\n      <div style={{\n        position: \"absolute\",\n        bottom: \"10px\",\n        left: \"10px\",\n        background: \"rgba(0,0,0,0.7)\",\n        padding: \"5px 10px\",\n        borderRadius: \"6px\",\n        color: \"white\",\n        fontSize: \"0.9rem\"\n      }}>\n        Participante\n      </div>\n    </div>\n  );\n}\n\nexport default Room;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}